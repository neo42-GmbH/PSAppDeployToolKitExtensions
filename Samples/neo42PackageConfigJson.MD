This file contains descriptions to all possible values in the file neo42PackageConfig.json for processing a setup.
# general information
## good to know
*By the way ***backtick*** is the general masking character for later usage of control characters inside powershell, but consider following masking rules for characters in json files at all:*

| character | mask with | looks like | comments 
|:-----------:|:-----------:|:-----------:|:-----------:|
| " | backtick | `" | necessary for expandable variable content in powershell |
| $ | backtick | `$ | necessary for expandable variable content in powershell |
| \ | backslash | \\\ | necessary inside json file itself |
## accessing values of other config files parsed into a global variable set
*general notation: $($global:\<VariableSetName\>.\<(optional)SubSection(s)\>.\<VariableName\>)*

following VariableSets of config files are useable (in order of availability):
- xml format (only this has to use in this way: **$script**:xmlConfig)
    - xmlConfig - AppDeployToolkitConfig.xml (default ADT framework settings; note: many of sub sections have own VariableNames defined too)
- json format
    - PackageConfig - neoPackageConfig.json (this file)
- ini format
    - SetupCfg - Setup.cfg (default file for configurable settings by customer)
    - CustomSetupCfg - CustomSetup.cfg (special file for configurable settings by customer)

## architecture depending variables generated by AppDeployToolkitExtensions
**These variables are recommended to use inside of defined variables first!**
### *("AppArch" = "x86") or ("AppArch" = "\*") on 32bit windows platform*
| useable script variable | set content | resulting variable value |
| ----------------------------------- | ----------------------------------- | ----------------------------------- |
| *- filesystem -* |||
| $global:ProgramFilesDir | ${ProgramFiles} | C:\Program Files |
| $global:ProgramFilesDirx86 | ${ProgramFiles(x86)} | C:\Program Files |
| $global:ProgramW6432 | '' | |
| $global:CommonFilesDir | ${CommonProgramFiles(x86)} | C:\Program Files\Common Files |
| $global:CommonFilesDirx86 | ${CommonProgramFiles(x86)} | C:\Program Files\Common Files |
| $global:CommonProgramW6432 | '' | |
| $global:System | $SystemRoot\System32 | C:\Windows\System32 |
| *- registry -* |||
| $global:Wow6432Node | '' | |
| $global:RegSoftwarePath | 'HKLM:\Software' | HKLM:\Software |
| $global:RegSoftwarePathx86 | 'HKLM:\Software' | HKLM:\Software |

### *("AppArch" = "x86") on 64bit windows platform*
| useable script variable | set content | resulting variable value |
| ----------------------------------- | ----------------------------------- | ----------------------------------- |
| *- filesystem -* |||
| $global:ProgramFilesDir | ${ProgramFiles(x86)} | C:\Program Files (x86) |
| $global:ProgramFilesDirx86 | ${ProgramFiles(x86)} | C:\Program Files (x86) |
| $global:ProgramW6432 | $ProgramFiles | C:\Program Files |
| $global:CommonFilesDir | ${CommonProgramFiles(x86)} | C:\Program Files (x86)\Common Files |
| $global:CommonFilesDirx86 | ${CommonProgramFiles(x86)} | C:\Program Files (x86)\Common Files |
| $global:CommonProgramW6432 | $CommonProgramFiles | C:\Program Files\Common Files |
| $global:System | $SystemRoot\SysWOW64 | C:\Windows\SysWOW64 |
| *- registry -* |||
| $global:Wow6432Node | '\Wow6432Node' | \Wow6432Node |
| $global:RegSoftwarePath | 'HKLM:\Software' | HKLM:\Software |
| $global:RegSoftwarePathx86 | 'HKLM:\Software\Wow6432Node' | HKLM:\Software\Wow6432Node |

### *("AppArch" = "x64") or ("AppArch" = "\*") on 64bit windows platform*
| useable script variable | set content | resulting variable value |
| ----------------------------------- | ----------------------------------- | ----------------------------------- |
| *- filesystem -* |||
| $global:ProgramFilesDir | $ProgramFiles | C:\Program Files |
| $global:ProgramFilesDirx86 | ${ProgramFiles(x86)} | C:\Program Files (x86) |
| $global:ProgramW6432 | $ProgramFiles | C:\Program Files |
| $global:CommonFilesDir | $CommonProgramFiles | C:\Program Files\Common Files |
| $global:CommonFilesDirx86 | ${CommonProgramFiles(x86)} | C:\Program Files (x86)\Common Files |
| $global:CommonProgramW6432 | $CommonProgramFiles | C:\Program Files\Common Files |
| $global:System | $SystemRoot\System32 | C:\Windows\System32 |
| *- registry -* |||
| $global:Wow6432Node | '' | |
| $global:RegSoftwarePath | 'HKLM:\Software' | HKLM:\Software |
| $global:RegSoftwarePathx86 | 'HKLM:\Software\Wow6432Node' | HKLM:\Software\Wow6432Node |
## values of json variables expanded during parsing into global variable set $global:PackageConfig
*only these variable values may contain a reference to a variable again*
- SoftMigration.File.FullNameToCheck
- UninstallDisplayName
- App
- DisplayNamesToExcludeFromAppSearches (each list entry of a collection)
- InstallLocation
- InstLogFile
- UninstLogFile
- InstFile
- InstPara
- UninstFile
- UninstPara
- UninstallKeysToHide.KeyNameIsDisplayName
- UninstallKeysToHide.KeyNameContainsWildCards
- UninstallKeysToHide.DisplayNamesToExcludeFromHiding

# json variable descriptions

**"ScriptAuthor"** *mandatory informational string value*

parent: /
```
default value: "neo42 GmbH"
author of the script
```
**"ScriptDate"** *mandatory informational string value*

parent: /
```
initial date of script creation in format "DD/MM/YYYY"
```

**"InventoryID"** *mandatory string value*

parent: /
```
internal unique identifier with 11 digits with format: 3 digits employee name abbreviation + 8 digits random hexadecimal number
```

**"Description"** *optional informational string value*

parent: /
```
default value: ""
a package description as free text
```

**"InstallMethod"** *mandatory string value*

parent: /
```
default value: may define a well-known type of setups (especially for MSI setups the default MSI engine installation switch '/i' will be executed), else (if an individual text is defined here) a regular process execution of an existing "InstFile" with defined "InstPara" is tried to call

install method used for default setup execution in main routine

for a well-known type of setups pre-defined parameter sets are used for default installation processing, to use customized parameters see values "InstPara" and "AppendInstParaToDefaultParameters"
additionally the defined "AcceptedInstallExitCodes" always are provided to the default process execution
to test process and/or registry conditions in setup pre-succes check state use settings in sub-structure "Install" of value "TestConditionsPreSetupSuccessCheck"

note: a value of 'none' will skip the default installation procedure (in this case manual steps for installation in a corresponding custom function are possible/necessary)
```
for following well-known types of setups pre-defined parameter sets in file 'AppDeployToolkitConfig.xml' are available (value is NOT case-sensitive):
- **MSI**: if value is set to '*MSI*' only the default process execution with corresponding parameter set of a MSI setup will be done
- **InnoSetup**: all values like '*Inno\**' will do default process execution with corresponding parameter set of legacy setup 'InnoSetup'
- **NullSoft/NSIS**: if value is set to '*NullSoft*' only the default process execution with corresponding parameter set of legacy setup 'NullSoft' will be done
- **BitRockInstaller**: all values like '*BitRock\**' will do default process execution with corresponding parameter set of legacy setup 'BitRockInstaller'
- **none**: if value is set to '*none*' only any of the pre-defined procedures for well-known types of setups mentioned above will be skipped

following pre-defined parameter set will be used (see value "MSI_InstallParams"/"Nxt\<setup_type\>_InstallParams" in section "MSI_Options"/"Nxt\<setup_type>_Options" in file 'AppDeployToolkitConfig.xml'):
```
MSI_InstallParams: MSIRESTARTMANAGERCONTROL=Disable REBOOT=ReallySuppress ALLUSERS=1 /qn

NxtInnoSetup_InstallParams       : /FORCEINSTALL /VERYSILENT /SP- /SUPPRESSMSGBOXES /NOCANCEL /NORESTART /RESTARTEXITCODE=3010
NxtNullsoft_InstallParams        : /AllUsers /S
NxtBitRockInstaller_InstallParams: --mode unattended

note: a log file parameter always will be appended, if supported by setup type (see description of value "InstLogFile" too)
```

**"UninstallMethod"** *mandatory string value*

parent: /
```
default value: may define a well-known type of setups (especially for MSI setups the default MSI engine installation switch '/x' will be executed), else (if an individual text is defined here) a regular process execution of an existing "UninstFile" with defined "UninstPara" is tried to call

uninstall method used for default setup execution in main routine

for a well-known type of setups pre-defined parameter sets are used for default uninstallation processing, to use customized parameters see values "UninstPara" and "AppendUninstParaToDefaultParameters"
additionally the defined "AcceptedUninstallExitCodes" always are provided to the default process execution
to test process and/or registry conditions in setup pre-succes check state use settings in sub-structure "Uninstall" of value "TestConditionsPreSetupSuccessCheck"

note: a value of 'none' will skip the default uninstallation procedure (in this case manual steps for uninstallation in a corresponding custom function are possible/necessary)
```
for following well-known types of setups pre-defined parameter sets in file 'AppDeployToolkitConfig.xml' are available (value is NOT case-sensitive):
- **MSI**: if value is set to '*MSI*' only the default process execution with corresponding parameter set of a MSI setup will be done
- **InnoSetup**: all values like '*Inno\**' will do default process execution with corresponding parameter set of legacy setup 'InnoSetup'
- **NullSoft/NSIS**: if value is set to '*NullSoft*' only the default process execution with corresponding parameter set of legacy setup 'NullSoft' will be done
- **BitRockInstaller**: all values like '*BitRock\**' will do default process execution with corresponding parameter set of legacy setup 'BitRockInstaller'
- **none**: if value is set to '*none*' only any of the pre-defined procedures for well-known types of setups mentioned above will be skipped

following pre-defined parameter set will be used (see value "MSI_UninstallParams"/"Nxt\<setup_type\>_UninstallParams" in section "MSI_Options"/"Nxt\<setup_type>_Options" in file 'AppDeployToolkitConfig.xml'):
```
MSI_UninstallParams: MSIRESTARTMANAGERCONTROL=Disable REBOOT=ReallySuppress /qn

NxtInnoSetup_UninstallParams       : /VERYSILENT /SP- /SUPPRESSMSGBOXES /NOCANCEL /NORESTART /RESTARTEXITCODE=3010
NxtNullsoft_UninstallParams        : /AllUsers /S
NxtBitRockInstaller_UninstallParams: --mode unattended

note: a log file parameter always will be appended, if supported by setup type (see description of value "UninstLogFile" too)
```

**"ReinstallMode"** *mandatory string value*

parent: /
```
default value: "Reinstall", but "MSIRepair" is recommended for MSI setups (executes default MSI engine repair switch '/fvomus' with default pre-defined parameter set for installation, to use customized parameters see values "InstPara" and "AppendInstParaToDefaultParameters")

reinstall mode used for default setup execution in main routine

especially for MSI setups in case provided value "UninstallKey" is a display name (value "UninstallKeyIsDisplayName" is set to "true"), reinstall mode may be changed dynamically by function "Switch-NxtMSIReinstallMode" depending of double check result for display version of installed application (prevents running the repair procedure for wrong MSIGUID!)

additionally the defined "AcceptedRepairExitCodes" are provided to the default process execution
note: additionally valid value is "Install" (important: like for mode 'Reinstall' the related settings for the corresponding values "InstallMethod" and "UninstallMethod" will be used!)
```
- **MSIRepair**: does a default MSI setup integrated repair procedure - note: usage with legacy setups will throw a controlled error!
- **Reinstall**: does an external 2-step procedure with a regular uninstallation procedure first and an regular installation procedure again afterwards (note: an intermediate reboot may be required!)
- **Install**: does a regular installation procedure (it's just an "over-installing", especially for MSI setups it may do an inplace upgrade if allowed by value 'MSIInplaceUpgradeable' in case of detecting installed application just with DISPLAYNAME instead of MSIGUID as Uninstallkey) - note: be careful, the application/setup has to support this procedure!

**"MSIInplaceUpgradeable"** *optional bool value (considered for MSI setups only!)*

parent: /
```
default value: false
switch for a valid inplace upgrade (valid are only 'true' and 'false')
note: only set it on demand if this option is safe for this MSI setup
```

**"MSIDowngradeable"** *optional bool value (considered for MSI setups only!)*

parent: /
```
default value: false
switch for a valid downgrade (valid are only 'true' and 'false')
note: only set it on demand if this option is safe for this MSI setup
```

**"SoftMigration":** *optional value structure collection (children have to be surrounded by ***{}***)*

parent: /

note: following sequence is proceeded for soft migration decision:
1. if variable '$global:SoftMigrationCustomResult' is true (maybe set in custom function 'CustomSoftMigrationBegin' if a custom procedure is used)
2. else if this structure with file name and/or file version is fullfilled (see following sub-structure "File")
3. else if detected display version of the same application (if installed) is greater than or equal to display version set in variable "DisplayVersion"

note: the following sub-structure "File" is singular (by default it may be tested for only one file name/version)!

***"File":*** *mandatory value sub-structure (children have to be surrounded by {})*

parent: /SoftMigration/

**"FullNameToCheck"** *optional string value*

parent: /SoftMigration/File/
```
default value: ""
points to a file (including full path) to check for soft migration decision (if file is there AND no file version is set soft migration will be done)
```

**"VersionToCheck"** *optional string value*

parent: /SoftMigration/File/
```
default value: ""
file version to check for soft migration decision (if file version of existing file is same or newer do soft migration)
```

**"TestedOn"** *mandatory informational string value*

parent: /
```
comma separated list of tested Windows platforms in one string
note: generally it would be like this "Win x86, Win10 x64, Win11 x64"
```

**"Dependencies"** *mandatory informational string value*

parent: /
```
default value: ""
comma separated list of depending applications, Windows features or services in one string (if any)
note: usually these dependencies should be pre-checked in a custom function (i.e. 'CustomInstallAndReinstallBegin') of script too
```

**"LastChange"** *mandatory informational string value*

parent: /
```
date of last script manipulation in format "DD/MM/YYYY"
```

**"Build"** *mandatory string value*

parent: /
```
default value: "0"
build number of the script starting with 0 for each revision (in general it is a numeric value as type 'string')
note: increment this value if script is changed AND package is not already distributed to clients
```

**"AppArch"** *mandatory string value*

parent: /
```
application architecture of the packaged application
note: depends on installation location in file system and position in registry hive and these values are valid: "x86", "x64", "*" only
```
- x86: it is a 32bit application
- x64: it is a 64bit application
- \*  : behavior of application on x86 and x64 platforms is different or package contains both application architectures

**"AppVendor"** *mandatory string value*

parent: /
```
application manufacturer name of the packaged application
note: basically it must NOT contain corporate forms like 'GmbH' or 'Ltd.' and so on
```

**"AppName"** *mandatory string value*

parent: /
```
application name of the packaged application
note: basically it must NOT contain version numbers except so called branding versions like 'Office 2019'
```

**"AppVersion"** *mandatory string value*

parent: /
```
real version number of the packaged application (like noted in registry uninstall entry, if set there)
note: in general it must NOT be a so called branding number, but a numeric value in format 'aaa.bbb.ccc.ddd' as type 'string'
```

**"AppRevision"** *mandatory string value*

parent: /
```
default value: "0"
revision number of the application package starting with 0 (in general it is a numeric value as type 'string')
note: increment this value if script/package content is changed AND package has to re-distribute to clients (possibly reset build number to zero again)
```

**"AppLang"** *mandatory string value*

parent: /
```
application language of the packaged application
note: basically only these values are valid and supported by neo42: "DEU", "ENG", "MUI"
```

**"ProductGUID"** *mandatory string value*

parent: /
```
universal unique identifier in regular GUID format with random hexadecimal numbers like "{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXX}" for a single product (may be a collection of more than one package)
note: the 3 very left digits inside of curly brackets are always "042"
```

**"PackageGUID"** *mandatory string value*

parent: /
```
universal unique identifier in regular GUID format with random hexadecimal numbers like "{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXX}" for a single package
note: the 3 very left digits inside of curly brackets are always "042"
```

**"RegPackagesKey"** *mandatory string value*

parent: /
```
default value: "neoPackages"
registry sub key to store all package depending information seperated by "PackageFamilyGUID" (always stored in registry path HKLM:\Software)
```

**"UninstallDisplayName"** *mandatory string value*

*(note: may contain reference to other defined variables, content will be expanded)*

parent: /
```
default value: "neoPackage $($global:PackageConfig.AppVendor) $($global:PackageConfig.appName) $($global:PackageConfig.appVersion)"
registered display name of uninstall registry entry of installed application package on client system (= data of value name 'DisplayName' for the installed application package entry under registry path '..\CurrentVersion\Uninstall\"PackageFamilyGUID"')
note: this package system registration is done additionally to a regular manufacturer setup own registration in registry and may be suppressed by deployment system (if variable '$env:registerPackage' is set to '$false')
```

**"App"** *mandatory string value*

*(note: may contain reference to other defined variables, content will be expanded)*

parent: /
```
default value: "$($env:ProgramData)\\neoPackages\\$($global:PackageConfig.appVendor)\\$($global:PackageConfig.appName)\\$($global:PackageConfig.appVersion)"
package cache folder on client system (i.e. possible user parts of package are executed from there)
```
 
**"UninstallOld"** *optional bool value*

parent: /
```
default value: true
switch to instruct script to remove packages in former framework versions (especially Empirum setup.inf packages) and/or with same "PackageFamilyGUID" (especially packages in VBS style)
note: this value may be overwritten by deployment system (if variable '$env:uninstallOld' is set)
```

**"Reboot"** *mandatory integer value*

parent: /
```
default value: 0
reboot behavior of package (only values '0', '1' and '2' are allowed)
note: this value may be overwritten by deployment system (if variable '$env:Reboot' is set)
```
- 0: no reboot required (don't overwrites main exit code inside script)
- 1: reboot required (always overwrites main exit code inside script to exit code 3010)
- 2: hide reboot (overwrites exit codes 1641 and 3010 inside script to exit code 0 only, all other exit codes will be passed through

**"UserPartOnInstallation"** *optional bool value*

parent: /
```
default value: false
switch of behavior for installation of an user part of package during main installation process, by default this value should be set to 'true' if the package contains an user part (valid are only 'true' and 'false')
note: the script may be called explicit with a parameter later: synchonously 'Deploy-Application.ps1 -InstallUserPart' or asynchronously 'Deploy-Application.ps1 -TriggerInstallUserPart'
```

**"UserPartOnUninstallation"** *optional bool value*

parent: /
```
default value: false
switch of behavior for uninstallation of an user part of package during main uninstallation process, by default user parts should not be triggered to be uninstalled even if there are ones except requested i.e. by customer (valid are only 'true' and 'false')
note: the script may be called explicit with a parameter later: synchonously 'Deploy-Application.ps1 -UninstallUserPart' or asynchronously 'Deploy-Application.ps1 -TriggerUninstallUserPart'
```

**"UserPartRevision"** *optional string value*

parent: /

note: this value is mandatory if the value "UserPartOnInstallation" and/or "UserPartOnUninstallation" is set to 'true'
```
default value: ""
uses a unique value for the user part of the package in comma separated format derived from value "ScriptDate" expanded by a counter starting with 0 like "2023,06,08,00"
note: to re-run the user part installation together with a package reinstallation the added counter has to be incremented
```

**"HidePackageUninstallButton"** *optional bool value*

parent: /
```
default value: false
switch to hide own uninstall button for this package in system control settings (valid are only 'true' and 'false')
```

**"HidePackageUninstallEntry"** *optional bool value*

parent: /
```
default value: false
switch to hide own uninstall registry entry for this package (defined in value "UninstallDisplayName") in system control settings (valid are only 'true' and 'false')
```

**"DisplayVersion"** *optional string value*

parent: /
```
default value: (expected) version of installed application (by default taken from registry value 'DisplayVersion' in uninstall registry entry set by a regular test installation of the application)
note: if this value is not set no default soft migration is proceeded (see description of value "SoftMigration" too) and especially for MSI setups no double check for correct decision of "ReinstallMode" may be done in case value "UninstallKeyIsDisplayName" is set to 'true' (see description of values "UninstallKey" and "UninstallKeyIsDisplayName" too)!
```

**"InstallerVersion"** *optional string value*

parent: /
```
default value: ""
possible part of setup installer file name set in value "InstFile"
note: this variable is not used by default in any function of AppDeployToolkitExtensions, but may be used in value "InstFile" or in custom functions
```

**"UninstallKey"** *optional string value*

parent: /
```
default value: name of registry subkey in uninstall registry entry of installed application setup ('...\CurrentVersion\Uninstall\"UninstallKey"'), especially for MSI setups generally this is the MSI-GUID
used for application detection as search string (for an uninstall registry subkey or a display name) of installed application
note: if this value is set dynamically at runtime of un/installation process (or is not defineable at startup) here may be defined the display name of the installed application set in registry key 'DisplayName' in uninstall registry entry of installed application (in this case it is mandatory to set value "UninstallKeyIsDisplayName" to 'true'); this value may be empty too (in this case no default application detection is possible, custom actions have to be defined in custom functions)
```

**"UninstallKeyIsDisplayName"** *optional bool value*

parent: /

note: this value is mandatory if the value "UninstallKey" contains the display name of installed application
```
default value: false
switch to define the usage of the value "UninstallKey" as search string for a display name of installed application set in registry key 'DisplayName' in uninstall registry entry of installed application (valid are only 'true' and 'false')
```

**"UninstallKeyContainsWildCards"** *optional bool value*

parent: /
```
default value: false
switch to control the interpretation of character '*' in a defined string of value "UninstallKey" (valid are only 'true' and 'false')
```
- true : '\*' is interpreted as a wildcard
- false: '\*' is interpreted as part of the defined string

**"DisplayNamesToExcludeFromAppSearches":** *optional string value list (has to be surrounded by [])*

parent: /

*(note: may contain reference to other defined variables, content will be expanded)*
```
default value: "$($global:PackageConfig.UninstallDisplayName)"
comma separated list of display name strings to exclude from application searches
note: an empty list is allowed that means: "DisplayNamesToExcludeFromAppSearches": []), but at least the default value is recommended to prevent finding entry of current installed application package defined in value "UninstallDisplayName" (see description of value "UninstallDisplayName" too)!
```

**"InstallLocation"** *optional string value*

parent: /

*(note: may contain reference to other defined variables, content will be expanded)*
```
default value: ""
installation path of application proceeded by setup
note: this variable is not used by default in any function of AppDeployToolkitExtensions, but may be used for a parameter of setup call (i.e. in value "InstPara") or in custom functions
```

**"InstLogFile"** *mandatory string value*

parent: /

*(note: may contain reference to other defined variables, content will be expanded)*
```
default value: "$($global:PackageConfig.app)\\Install.$global:DeploymentTimestamp.log"
setup log file name for installation process
note: by default a logfile always will be appended internally (if value "InstallMethod" is set to a well-know type of setups and logging is supported/applied by setup), even if no name is provided in this variable!
```

**"UninstLogFile"** *mandatory string value*

parent: /

*(note: may contain reference to other defined variables, content will be expanded)*
```
default value: "$($global:PackageConfig.app)\\Uninstall.$global:DeploymentTimestamp.log"
setup log file name for uninstallation process
note: by default a logfile always will be appended internally (if value "UninstallMethod" is set to a well-know type of setups and logging is supported/applied by setup), even if no name is provided in this variable!
```

**"InstFile"** *mandatory string value*

parent: /

*(note: may contain reference to other defined variables, content will be expanded)*
```
name of the used setup installer file (including file extension)
note: by default this file will be expected in package subfolder 'Files', else add a (relative) path to the provided file name; in case of value "InstallMethod" is set to "none" the provided value "InstFile" will be ignored by default installation routine (see description of value "InstallMethod" too)
```

**"InstPara"** *optional string value*

parent: /

*(note: may contain reference to other defined variables, content will be expanded)*
```
default value: ""
collection of setup installer parameters as one string, but don't include a log file parameter, if "InstallMethod" is set to a well-know type of setups (see descriptions of values "InstallMethod" and "InstLogFile" too)
note: especially consider masking rules for some characters inside the string
```

**"AppendInstParaToDefaultParameters"** *optional bool value*

parent: /

```
default value: false
switch to control the behavior for using the defined parameters in value "InstPara" (valid are only 'true' and 'false')
note: by default a logfile always will be appended to used parameters (if supported/applied by setup), even if parameters will be replaced!
```
- true : appends the parameters to this one get from the corresponding msi parameters entry in ADT config file 'AppDeployToolkitConfig.xml'
- false: replaces the parameters got from the corresponding msi parameters entry in ADT config file 'AppDeployToolkitConfig.xml'

**"AcceptedInstallExitCodes"** *optional string value*

parent: /

```
default value: ""
comma separated list of exit codes to accept for successfull installation execution of the used setup installer file
note: '*' is allowed for all exit codes
```

**"AcceptedRepairExitCodes"** *optional string value (considered for MSI setups only!)*

parent: /

```
default value: ""
comma separated list of exit codes to accept for successfull repair execution of msi setup file
note: '*' is allowed for all exit codes
```

**"UninstFile"** *optional string value*

parent: /

*(note: may contain reference to other defined variables, content will be expanded)*
```
default value: ""
alternative name of the setup uninstaller file (including file extension and full path to it's location)
note: by default the MSI-GUID provided in value "UninstallKey" or a derived uninstall registry key from corresponding application registry value 'DisplayName' tried to use for uninstallation and only if this uninstall entry does not exist the default uninstallation routine switches to the defined value of "UninstFile"; in case of value "UninstallMethod" is set to "none" the provided value "UninstFile" will be ignored by default uninstallation routine (see description of value "UninstallMethod" too)
```

**"UninstPara"** *optional string value*

parent: /

*(note: may contain reference to other defined variables, content will be expanded)*
```
default value: ""
collection of setup uninstaller parameters as one string, but don't include a log file parameter, if "UninstallMethod" is set to a well-know type of setups (see descriptions of values "UninstallMethod" and "UninstLogFile" too)
note: especially consider masking rules for some characters inside the string
```

**"AppendUninstParaToDefaultParameters"** *optional bool value*

parent: /
```
default value: false
switch to control the behavior for using the defined parameters in value "UninstPara" (valid are only 'true' and 'false')
note: by default a logfile always will be appended to used parameters (if supported/applied by setup), even if parameters will be replaced!
```
- true : appends the parameters to these one got from the corresponding msi parameters entry in ADT config file 'AppDeployToolkitConfig.xml'
- false: replaces the parameters got from the corresponding msi parameters entry in ADT config file 'AppDeployToolkitConfig.xml'

**"AcceptedUninstallExitCodes"** *optional string value*

parent: /
```
default value: ""
comma separated list of exit codes to accept for successfull uninstallation execution of the used setup installer file
note: '*' is allowed for all exit codes
```

**"AppKillProcesses":** *optional value structure (possibly a collection) (children have to be surrounded by [])*

parent: /

note: the following sub-structure (each member group in curly brackets) may be copied any times it's necessary, has to be comma-separated and at least the value "Name" has to be provided for each entry, but an empty list is allowed too (that means: "AppKillProcesses": [])!

**"Name"** *mandatory string value*

parent: /AppKillProcesses/

```
a type 'exe' process file name for check to kill (with or without file extension)
note: there are wildcards allowed, but just wildcards only will be prevented for usage
```

**"Description"** *optional string value*

parent: /AppKillProcesses/
```
default value: ""
text will be shown instead of default file description value of the process file in process close list of user information window (for better 'human understanding')
```

**"BlockExecution"** *optional bool value*

parent: /
```
default value: true
switch prevent start each of the defined process name during un/installation procedure (valid are only 'true' and 'false')
note: if defined values "Name" in "AppKillProcesses" are including wildcard only process names are matching running processes at initial process check will recognized for blocking later!
```

**"TestConditionsPreSetupSuccessCheck":** *optional value structure (children have to be surrounded by ***{}***)*

parent: /

value collection to control pre setup success checks for process items and/or registry items

**"Install":** *mandatory value sub-structure (children have to be surrounded by {})*

parent: /TestConditionsPreSetupSuccessCheck/

value sub-collection provides an optional custom opportunity for checking conditions after finishing the default setup installation routine and checking for installation state on the client and is valid for process items and/or registry items in last step during default installation process

note: empty lists for process items and/or registry items are allowed!
 
**"TotalSecondsToWaitFor"** *mandatory integer value*

parent: /TestConditionsPreSetupSuccessCheck/Install/
```
default value: 30
total time in seconds to wait for (all) process items/registry items to be completed
```

**"ProcessOperator"** *mandatory string value*

parent: /TestConditionsPreSetupSuccessCheck/Install/
```
default value: "And"
behavior of logical connection between more then one provided process item in sub-structure "ProcessesToWaitFor"
note: valid values are "And" and "Or"
```

**"ProcessesToWaitFor":** *optional value sub-structure (possibly a collection) (children have to be surrounded by [])*

parent: /TestConditionsPreSetupSuccessCheck/Install/

note: the following optional sub-structure (each member group in curly brackets) may be copied any times it's necessary, has to be comma-separated and both values "Name" and "ShouldExist" have to be provided for each item, but an empty list is allowed too (that means: "ProcessesToWaitFor": [],)!

**"Name"** *mandatory string value*

parent: /TestConditionsPreSetupSuccessCheck/Install/ProcessesToWaitFor/
```
process file name (with or without file extension) to monitor
note: there are wildcards allowed, but just wildcards only will be prevented for usage
```

**"ShouldExist"** *mandatory bool value*

parent: /TestConditionsPreSetupSuccessCheck/Install/ProcessesToWaitFor/
```
value dependent of expected behavior for existence of the process (valid are only 'true' and 'false')
```

**"RegKeyOperator"** *mandatory string value*

parent: /TestConditionsPreSetupSuccessCheck/Install/
```
default value: "And"
behavior of logical connection between more then one provided registry item in sub-structure "RegKeysToWaitFor"
note: valid values are "And" and "Or"
```

**"RegKeysToWaitFor":** *optional value sub-structure (possibly a collection) (children have to be surrounded by [])*

parent: /TestConditionsPreSetupSuccessCheck/Install/

note: the following optional sub-structure (each member group in curly brackets) may be copied any times it's necessary, has to be comma-separated and at least the values "KeyPath" and "ShouldExist" have to be provided for each item, but an empty list is allowed too (that means: "RegKeysToWaitFor": [])!

**"KeyPath"** *mandatory string value*

parent: /TestConditionsPreSetupSuccessCheck/Install/RegKeysToWaitFor/
```
registry path of the registry key/value to monitor
```

**"ValueName"** *optional string value*

parent: /TestConditionsPreSetupSuccessCheck/Install/RegKeysToWaitFor/
```
default value: null
registry value name of provided registry key in "KeyPath" to monitor
```

**"ValueData"** *optional string value*

parent: /TestConditionsPreSetupSuccessCheck/Install/RegKeysToWaitFor/
```
default value: null
registry value data of provided registry value in "ValueName" to monitor
note: will be checked for exact the same content of registry value data like provided in "ValueData" only!
```

**"ShouldExist"** *mandatory bool value*

parent: /TestConditionsPreSetupSuccessCheck/Install/RegKeysToWaitFor/
```
value dependent of expected behavior for existence of the registry key (valid are only 'true' and 'false')
```

**"Uninstall":** *optional value sub-structure (children have to be surrounded by {})*

parent: /TestConditionsPreSetupSuccessCheck/

sub-collection provides an optional custom opportunity for checking conditions after finishing the default setup uninstallation routine and checking for uninstallation state on the client and is valid for process items and/or registry items in last step during default uninstallation process

note: empty lists for process items and/or registry items are allowed!

**"TotalSecondsToWaitFor"** *mandatory integer value*

parent: /TestConditionsPreSetupSuccessCheck/Uninstall/
```
default value: 30
total time in seconds to wait for (all) process items/registry items to be completed
```

**"ProcessOperator"** *mandatory string value*

parent: /TestConditionsPreSetupSuccessCheck/Uninstall/
```
default value: "And"
behavior of logical connection between more then one provided process item in sub-structure "ProcessesToWaitFor"
note: valid values are "And" and "Or"
```

**"ProcessesToWaitFor":** *optional value sub-structure (possibly a collection) (children have to be surrounded by [])*

parent: /TestConditionsPreSetupSuccessCheck/Uninstall/

note: the following optional sub-structure (each member group in curly brackets) may be copied any times it's necessary, has to be comma-separated and both values "Name" and "ShouldExist" have to be provided for each item, but an empty list is allowed too (that means: "ProcessesToWaitFor": [],)!

**"Name"** *mandatory string value*

parent: /TestConditionsPreSetupSuccessCheck/Uninstall/ProcessesToWaitFor/
```
process file name (with or without file extension) to monitor
note: there are wildcards allowed, but just wildcards only will be prevented for usage
```

**"ShouldExist"** *mandatory bool value*

parent: /TestConditionsPreSetupSuccessCheck/Uninstall/ProcessesToWaitFor/
```
value dependent of expected behavior for existence of the process (valid are only 'true' and 'false')
```

**"RegKeyOperator"** *mandatory string value*

parent: /TestConditionsPreSetupSuccessCheck/Uninstall/
```
default value: "And"
behavior of logical connection between  more then one provided registry item in sub-structure "RegKeysToWaitFor"
note: valid values are "And" and "Or"
```

**"RegKeysToWaitFor":** *optional value sub-structure (possibly a collection) (children have to be surrounded by [])*

parent: /TestConditionsPreSetupSuccessCheck/Uninstall/

note: the following optional sub-structure (each member group in curly brackets) may be copied any times it's necessary, has to be comma-separated and at least the values "KeyPath" and "ShouldExist" have to be provided for each item, but an empty list is allowed too (that means: "RegKeysToWaitFor": [])!

**"KeyPath"** *mandatory string value*

parent: /TestConditionsPreSetupSuccessCheck/Uninstall/RegKeysToWaitFor/
```
registry path of the registry key/value to monitor
```

**"ValueName"** *optional string value*

parent: /TestConditionsPreSetupSuccessCheck/Uninstall/RegKeysToWaitFor/
```
default value: null
registry value name of provided registry key in "KeyPath" to monitor
```

**"ValueData"** *optional string value*

parent: /TestConditionsPreSetupSuccessCheck/Uninstall/RegKeysToWaitFor/
```
default value: null
registry value data of provided registry value in "ValueName" to monitor
note: will be checked for exact the same content of registry value data like provided in "ValueData" only!
```

**"ShouldExist"** *mandatory bool value*

parent: /TestConditionsPreSetupSuccessCheck/Uninstall/RegKeysToWaitFor/
```
value dependent of expected behavior for existence of the registry key (valid are only 'true' and 'false')
```

**"CommonDesktopShortcutsToDelete":** *optional string value list (has to be surrounded by [])*

parent: /
```
comma separated list of public desktop shortcut names to delete
note: an empty list is allowed (that means: "CommonDesktopShortcutsToDelete": [])!
```

**"CommonStartMenuShortcutsToCopyToCommonDesktop":** *optional value structure (possibly a collection) (children have to be surrounded by [])*

parent: /

note: the following optional sub-structure (each member group in curly brackets) may be copied any times it's necessary, has to be comma-separated and both values "Source" and "TargetName" have to be provided for each item, but an empty list is allowed too (that means: "CommonStartMenuShortcutsToCopyToCommonDesktop": [])!

**"Source"** *mandatory string value*

parent: /CommonStartMenuShortcutsToCopyToCommonDesktop/
```
link file name from somewhere inside of public start menu folder (including relative start menu subfolder structure starting with subfolder 'Programs')
```

**"TargetName"** *optional string value*

parent: /CommonStartMenuShortcutsToCopyToCommonDesktop/
``` 
link file name on public desktop folder (necessary only if different name to Source)
```

**"UninstallKeysToHide":** *optional value structure (possibly a collection) (children have to be surrounded by []*

parent: /

this optional structure (each member group in curly brackets) may be copied any times it's necessary, has to be comma-separated and at least the values "KeyName", "Is64Bit", "KeyNameIsDisplayName" and "KeyNameContainsWildCards" have to be provided for each item, but an empty list is allowed too (that means: "UninstallKeysToHide": [])!

note: the recommended default entry is always a reference to the current installed application (but the value "Is64Bit" has to be approved always and readjusted if necessary)

**"KeyName"** *mandatory string value*

parent: /UninstallKeysToHide/

*(note: may contain reference to other defined variables, content will be expanded)*
```
default value: "$($global:PackageConfig.UninstallKey)"
name of uninstall registry key entry of a corresponding installed application to hide (under '..\CurrentVersion\Uninstall\"KeyName"'))
```

**"Is64Bit"** *mandatory bool value*

parent: /UninstallKeysToHide/
```
value dependent of architecture path is used in registry for defined value "KeyName" of current entry in "UninstallKeysToHide" (valid are only 'true' and 'false')
note: this value will be ignored if set on x86 windows architecture (ADT variable '$Is64Bit' is set to '$false')
```

**"KeyNameIsDisplayName"** *mandatory bool value*

parent: /UninstallKeysToHide/

*(note: may contain reference to other defined variables, content will be expanded)*
```
default value: "$($global:PackageConfig.UninstallKeyIsDisplayName)"
switch to define the usage of the value "KeyName" for current entry in "UninstallKeysToHide" as search string for a display name a the corresponding installed application set in registry key 'DisplayName' in uninstall registry entry of this corresponding installed application (valid are only 'true' and 'false')
```

**"KeyNameContainsWildCards"** *mandatory bool value*

parent: /UninstallKeysToHide/

*(note: may contain reference to other defined variables, content will be expanded)*
```
default value: "$($global:PackageConfig.UninstallKeyContainsWildCards)"
switch to control the interpretation of character '\*' in a defined string of value "KeyName" for current entry in "UninstallKeysToHide" (valid are only 'true' and 'false')
```
- true : '\*' is interpreted as a wildcard
- false: '\*' is interpreted as part of the defined string

**"DisplayNamesToExcludeFromHiding":** *optional string value list (has to be surrounded by [])*

parent: /UninstallKeysToHide/

*(note: may contain reference to other defined variables, content will be expanded)*
```
default value: "$($global:PackageConfig.UninstallDisplayName)"
comma separated list of display names to exclude from hiding, where a character '*' inside of each string here always will interpreted as part of the defined string!
note: an empty list is allowed that means: "DisplayNamesToExcludeFromHiding": []), but at least the value of the corresponding installed application package for a defined current "KeyName" is recommended to prevent hiding this package uninstall entry if current value of "KeyNameIsDisplayName" is set to 'true'!
```

**"PackageSpecificVariablesRaw"** *optional value structure (children have to be surrounded by []*

parent: /

value collection to define customer specific variables

note: the following sub-structure (each member group curly brackets) may be copied any times it's necessary, has to be comma-separated and at least the values "Name" and "Value" have to be provided for each item, but an empty list is allowed too (that means: "PackageSpecificVariablesRaw": [])!

**"Name"** *mandatory string value*

parent: /PackageSpecificVariablesRaw/
```
customer variable name
note: after parsing into variable set access to such a variable is done via '$global:PackageConfig.PackageSpecificVariables.<customer_variable_name>'
```

**"Value"** *mandatory string value*


parent: /PackageSpecificVariablesRaw/
*(note: may contain reference to other defined variables, content will be expanded)*
```
customer variable value
note: especially consider masking rules for some characters inside the string
```

**"ExpandVariables"** *optional bool value*

parent: /PackageSpecificVariablesRaw/
```
value dependent of necessary value extraction (valid are only 'true' and 'false')
note: this value may be omitted (that's equal to 'false')
```
